{"componentChunkName":"component---src-templates-blog-post-js","path":"/googleformapi/","result":{"data":{"site":{"siteMetadata":{"title":"Ian Chu","author":"Ian Chu","siteUrl":"https://ianccy.com","social":{"facebook":"chu1228"}}},"markdownRemark":{"id":"24d5d72c-8c8d-53da-a8b0-16cb9ab28ccc","fields":{"slug":"/2018-02-googleformapi/"},"headings":[{"value":"google excel 試算表 實作功能","id":"google-excel-試算表-實作功能","depth":2},{"value":"google sheet method 介紹","id":"google-sheet-method-介紹","depth":2},{"value":"STEP.1 打開 google 雲端硬碟 建立 google excel、建立 google AppScript","id":"step1-打開-google-雲端硬碟-建立-google-excel、建立-google-appscript","depth":3},{"value":"STEP.2 選擇剛剛創立的 google excel 網址參數","id":"step2-選擇剛剛創立的-google-excel-網址參數","depth":3},{"value":"STEP.3 打開 AppScript 加上剛剛複製的編碼 以及 javascript","id":"step3-打開-appscript-加上剛剛複製的編碼-以及-javascript","depth":3},{"value":"STEP.4 建立 debug.gs 來測試剛剛的 建立資料","id":"step4-建立-debuggs-來測試剛剛的-建立資料","depth":3},{"value":"STEP.5 編輯 允許權限","id":"step5-編輯-允許權限","depth":3},{"value":"STEP.6 部署為網路應用程式","id":"step6-部署為網路應用程式","depth":3},{"value":"STEP.7 建立 html 串接資料","id":"step7-建立-html-串接資料","depth":3},{"value":"使用心得","id":"使用心得","depth":2}],"excerpt":"要用到活動或是問卷，相信大家最常會用到 google form，非常快速的創出填表功能，但 google form 存在許多限制，我沒辦法創立特別的欄位，沒辦法做出一個複雜訂餐表單，表單長太醜(痾…其實我對 google 表單設定不太熟悉)。 或是不希望讓使用者點擊網址離開才能填表。最後網站只能鑲上 google…","html":"<p>要用到活動或是問卷，相信大家最常會用到 google form，非常快速的創出填表功能，但 google form 存在許多限制，我沒辦法創立特別的欄位，沒辦法做出一個複雜訂餐表單，表單長太醜(痾…其實我對 google 表單設定不太熟悉)。</p>\n<p>或是不希望讓使用者點擊網址離開才能填表。最後網站只能鑲上 google form 的 iframe 又無法追蹤填表操作動作，google analytics 轉換目標也不能設定。上面這些問題都可以用 google excel 的 api 來解決。</p>\n<!--- ![炸雞demo](../images/炸雞demo.png \"炸雞demo\") --->\n<p><a href=\"https://work.ianccy.com/%E7%82%B8%E9%9B%9E%E8%A8%82%E8%B3%BC\" title=\"炸雞訂購網頁\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">炸雞訂購網頁</a></p>\n<ul>\n<li>延伸文章: <a href=\"/googleformadv/\" title=\"客戶讀取、取消訂單\">客戶讀取、取消訂單</a></li>\n</ul>\n<h2 id=\"google-excel-試算表-實作功能\" style=\"position:relative;\"><a href=\"#google-excel-%E8%A9%A6%E7%AE%97%E8%A1%A8-%E5%AF%A6%E4%BD%9C%E5%8A%9F%E8%83%BD\" aria-label=\"google excel 試算表 實作功能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>google excel 試算表 實作功能</h2>\n<p>這邊要利用 google 試算表 增加資料 撈取 來實作一個網頁，簡單的鹹酥雞訂餐服務，老闆也可以修改處理狀態，讓顧客可以再取餐前查詢，到底老闆有沒有幫我做好鹹酥雞勒，還是放生我了 XD。</p>\n<p>只需要搭配 html + css + javascript。<br>\n（因為我家附近有間鹹酥雞，每次買都實在等太久，所以才想玩玩看。）</p>\n<h2 id=\"google-sheet-method-介紹\" style=\"position:relative;\"><a href=\"#google-sheet-method-%E4%BB%8B%E7%B4%B9\" aria-label=\"google sheet method 介紹 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>google sheet method 介紹</h2>\n<p>google 官方文件 <a href=\"https://developers.google.com/apps-script/reference/spreadsheet/sheet\" title=\"google sheet api\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">spreadsheet method</a>，裡面有非常詳盡的介紹，包括可以讀取欄位、讀取資料、排序資料、插入資料等等的功能，其實某方面來說算是功能齊全的類資料庫了。有興趣可以點開來看裡面文件。</p>\n<p>文件裡面 method 一大堆，還是直接實作比較快。</p>\n<h3 id=\"step1-打開-google-雲端硬碟-建立-google-excel、建立-google-appscript\" style=\"position:relative;\"><a href=\"#step1-%E6%89%93%E9%96%8B-google-%E9%9B%B2%E7%AB%AF%E7%A1%AC%E7%A2%9F-%E5%BB%BA%E7%AB%8B-google-excel%E3%80%81%E5%BB%BA%E7%AB%8B-google-appscript\" aria-label=\"step1 打開 google 雲端硬碟 建立 google excel、建立 google appscript permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STEP.1 打開 google 雲端硬碟 建立 google excel、建立 google AppScript</h3>\n<p>\n  <figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n  \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/35b3f7302494a9e625af0ff159a6be5a/a19a2/creatExcel.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 358px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 102.51396648044692%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsSAAALEgHS3X78AAACJElEQVQ4y41Ty47TMBTN57GYBXuEEH/Bhj0SiB0j+IJB4hNAYrJA0EpRpTbtUGU6tM2rzaN52nk5CccxBAYygaMosR0f33PuvZbKqs3LNskavDGum/b/Id1/mT56TZ++yx+/oWcv0k/rCqusvrWpafiRnucZhmHb9n6/13V9t9tJZ8/jB6+SJxfk4Xl671ksXxXYV7Kmbm49YAdhaBrG0XF0g4OTQ8LSonWTJsoaUrZVzeMMohdS13UYhnEcS4yxyZfPSRx5rrtaqrZljZgUR1RV5TgOXEiYwkKaEkKp758IIf/ME+KdTqcoiiRowKQXhnc/vUs8IidJgjASJrIs+75/OBwURTFNc7PZ9AoHAbLrupRSTkbqMcrzHGJwJMZFUYzIxt/FYoFgPGGXlzJox+NxPp+LyCjmSPC6A2+S7oNCsj6fvfm7PCMyAsCpVLFG2bIkb3NKEB8FxCoGI7LLstzc3ARBwMkf1TYgbUZTvesdrI6TIbZiXKlUsPKDpQRFkpPM7QDDmqYJ/qBtpAnZ5eSsKN7vFx6NM0JBQ8LQOuh7kEXN/wDCwvMPsudY5fZt5GjftsZSVVer1XQ6nc1maF2c4g9BFJmT4zhMXSWNHf8UGoaOmnd3Bg07ANFYaMwsyzi5L4CwKgo40h7CS951kdSnBEuowfiVEJt/kSeTCa61dn2tLpdf1+vdX9h2j2Wa9m/IRMLgzxkFr57nIUPQVfyEkPAdDXmsqvRv478AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/35b3f7302494a9e625af0ff159a6be5a/ed958/creatExcel.webp 358w\"\n          sizes=\"(max-width: 358px) 100vw, 358px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/35b3f7302494a9e625af0ff159a6be5a/a19a2/creatExcel.png 358w\"\n          sizes=\"(max-width: 358px) 100vw, 358px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/35b3f7302494a9e625af0ff159a6be5a/a19a2/creatExcel.png\"\n          alt=\"google creatExcel\"\n          title=\"google creatExcel\"\n          src=\"/static/35b3f7302494a9e625af0ff159a6be5a/a19a2/creatExcel.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    \n  <figcaption class=\"gatsby-resp-image-figcaption\">google creatExcel</figcaption>\n  </figure>\n      </p>\n<p>\n  <figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n  \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/14beed9086b4efadb2e23834ac3e6748/b8c2e/creatAppScript.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 679px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 87.47474747474747%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAAByElEQVQ4y31T0XKrIBTk1/vQ/k1nOv2M9rVvSSaaqAE1RkEEgmJXSAy9t/eujCPonj17zpF8bEesz52147zCWqu0GnApNY4j7lJKrbWbXbzI06t6ftMv77rX0zy7aXIgD8NQ1dXJY5ADpfSQHqqqmqZpjECkaNu2Ed3lasyq7NwSAmqNB77oug7380+QvpdC9JwLZPU3WQiBLOQdw08QBMjzHOkxxpBJTL54zP8GgSyWUkt41CkmI1XOedj+CsI6e2on3jZ1Xa+ZB3IPS1L+T5mKMhO0a9rj8QgL8Tu4CFGCzi9kLQojMsrqPM9QAxDsHcYY56a4ijEWcomGVnWapLB3ueN8bsqyhOWaGtlLdBj+Y83QcFIUBWX0hItRVrKwQqnQQJlkgossyxBrrcWDnCQJmgS3aCn3wIPzc2a1tskWzcCEoZ0YkpV/Ix8Oy9xhjEALggvZf6G1SdMWJ5gC8HEeaHh7G084RJPCuIUQ+ChMuOj7rz3P82K73ez3CdoRogcZVJRsNhuc7nY7JB8yX5WVMdWlRasR3fjJX3+J6/W6KIecIQtLD8+ejK7hAVu8DaH/9IwxEh78joeyUtghNARQbRiUEUD+BkIW0DFG/LNCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/14beed9086b4efadb2e23834ac3e6748/a805d/creatAppScript.webp 495w,\n/static/14beed9086b4efadb2e23834ac3e6748/f4cab/creatAppScript.webp 679w\"\n          sizes=\"(max-width: 679px) 100vw, 679px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/14beed9086b4efadb2e23834ac3e6748/b3db0/creatAppScript.png 495w,\n/static/14beed9086b4efadb2e23834ac3e6748/b8c2e/creatAppScript.png 679w\"\n          sizes=\"(max-width: 679px) 100vw, 679px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/14beed9086b4efadb2e23834ac3e6748/b8c2e/creatAppScript.png\"\n          alt=\"google creatAppScript\"\n          title=\"google creatAppScript\"\n          src=\"/static/14beed9086b4efadb2e23834ac3e6748/b8c2e/creatAppScript.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    \n  <figcaption class=\"gatsby-resp-image-figcaption\">google creatAppScript</figcaption>\n  </figure>\n      </p>\n<h3 id=\"step2-選擇剛剛創立的-google-excel-網址參數\" style=\"position:relative;\"><a href=\"#step2-%E9%81%B8%E6%93%87%E5%89%9B%E5%89%9B%E5%89%B5%E7%AB%8B%E7%9A%84-google-excel-%E7%B6%B2%E5%9D%80%E5%8F%83%E6%95%B8\" aria-label=\"step2 選擇剛剛創立的 google excel 網址參數 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STEP.2 選擇剛剛創立的 google excel 網址參數</h3>\n<p>xxxxxxxxxxx/edit，/edit 前面這段參數<br>\n<a href=\"https://docs.google.com...\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.google.com…</a><mark>1JbXssixJaqTL_BMgnmOiMxLyAZm0jOkw173VdewqO9c1</mark>/edit#gid=0</p>\n<h3 id=\"step3-打開-appscript-加上剛剛複製的編碼-以及-javascript\" style=\"position:relative;\"><a href=\"#step3-%E6%89%93%E9%96%8B-appscript-%E5%8A%A0%E4%B8%8A%E5%89%9B%E5%89%9B%E8%A4%87%E8%A3%BD%E7%9A%84%E7%B7%A8%E7%A2%BC-%E4%BB%A5%E5%8F%8A-javascript\" aria-label=\"step3 打開 appscript 加上剛剛複製的編碼 以及 javascript permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STEP.3 打開 AppScript 加上剛剛複製的編碼 以及 javascript</h3>\n<p>首先在 myFunction 上加入參數，因為之後要透過 call 這個 api 帶入資料，下面是預期會帶入的物件名稱 name、phone、time、order、price。這些都可以根據你想要帶的資料名稱變化，也可以刪減。</p>\n<p>後面是依靠 google sheet 的 method 來選取表單，後面貼上你剛剛 excel 的編碼，再來是用.getSheets()[0]來選取第 1 個工作表單。這樣就成功的選取到這整個 table 了。</p>\n<p>這邊先處理接到值傳進來先命名，再來選取你要填入的 google excel 編碼、excel tab。</p>\n<p>ps.這邊用的是 doGet function，代表這個 function 會被 api 的 Get 調用到，也可以用 doPost，但是你串接 api 就要改用 Post。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">doGet</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//接帶入值 轉為變數    - 可根據需求修改</span>\n  <span class=\"token keyword\">var</span> params <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span>parameter<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> name <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> phone <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>phone<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> time <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> order <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>order<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> price <span class=\"token operator\">=</span> params<span class=\"token punctuation\">.</span>price<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//這是選擇這個google excel</span>\n  <span class=\"token keyword\">var</span> SpreadSheet <span class=\"token operator\">=</span> SpreadsheetApp<span class=\"token punctuation\">.</span><span class=\"token function\">openById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"貼上你剛剛複製的編碼\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//取得 第一個表單</span>\n  <span class=\"token keyword\">var</span> Sheet <span class=\"token operator\">=</span> SpreadSheet<span class=\"token punctuation\">.</span><span class=\"token function\">getSheets</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>這邊比較搞剛的是要處理訂單編號，以便於日後我們比對資料方便，剩下最重要的塞剛剛帶進來的值。就完成的簡單的插入資料 function 了！</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  <span class=\"token operator\">...</span>\n  <span class=\"token comment\">//取得 LastRow = 有資料的最後一行的位置</span>\n  <span class=\"token keyword\">var</span> LastRow <span class=\"token operator\">=</span> Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getLastRow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\n  <span class=\"token comment\">// 這邊是處理訂單編號 - 我先選取 有資料最後一行 的 第6欄</span>\n  <span class=\"token keyword\">var</span> range <span class=\"token operator\">=</span> Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 創立訂單編號  (最後一行的第六欄 +1)</span>\n  <span class=\"token keyword\">var</span> orderNum <span class=\"token operator\">=</span> <span class=\"token function\">parseFloat</span><span class=\"token punctuation\">(</span>range<span class=\"token punctuation\">.</span><span class=\"token function\">getValues</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//若最後一行是第1行 需要轉為訂單編號1</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>LastRow <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    orderNum <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">//開始寫入資料 同樣是 getRange 選擇 (行,欄) setValue 帶入值name phone time order price values進來</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>phone<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>order<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>price<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getRange</span><span class=\"token punctuation\">(</span>LastRow<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span>orderNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//寫入結束後傳回true</span>\n  <span class=\"token keyword\">return</span> ContentService<span class=\"token punctuation\">.</span><span class=\"token function\">createTextOutput</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"step4-建立-debuggs-來測試剛剛的-建立資料\" style=\"position:relative;\"><a href=\"#step4-%E5%BB%BA%E7%AB%8B-debuggs-%E4%BE%86%E6%B8%AC%E8%A9%A6%E5%89%9B%E5%89%9B%E7%9A%84-%E5%BB%BA%E7%AB%8B%E8%B3%87%E6%96%99\" aria-label=\"step4 建立 debuggs 來測試剛剛的 建立資料 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STEP.4 建立 debug.gs 來測試剛剛的 建立資料</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//call</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">debug</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> Result <span class=\"token operator\">=</span> <span class=\"token function\">doGet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        parameter<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            name<span class=\"token operator\">:</span> <span class=\"token string\">'測試先生'</span><span class=\"token punctuation\">,</span>\n            phone<span class=\"token operator\">:</span> <span class=\"token string\">'0912345678'</span><span class=\"token punctuation\">,</span>\n            time<span class=\"token operator\">:</span> <span class=\"token string\">'2018/02/10 22:46:00'</span><span class=\"token punctuation\">,</span>\n            order<span class=\"token operator\">:</span> <span class=\"token string\">'鹹酥雞 * 1'</span><span class=\"token punctuation\">,</span>\n            price<span class=\"token operator\">:</span> <span class=\"token string\">'40'</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    Logger<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Result: %s'</span><span class=\"token punctuation\">,</span> Result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"step5-編輯-允許權限\" style=\"position:relative;\"><a href=\"#step5-%E7%B7%A8%E8%BC%AF-%E5%85%81%E8%A8%B1%E6%AC%8A%E9%99%90\" aria-label=\"step5 編輯 允許權限 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STEP.5 編輯 允許權限</h3>\n<p>ㄧ路點選允許到底即可</p>\n<p>這邊需要點進階 前往 xxx 不安全<br>\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n  \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/db5b73795778fac240b89db954ba6cd4/124dc/userright.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 666px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 95.35353535353536%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAIAAAAf7rriAAAACXBIWXMAAAsSAAALEgHS3X78AAACHElEQVQ4y5VTXY+TQBTtv/fBF/+CDyYm++LGRB/8AWrVarJlWyjQFigfAwPDZ2FmAA/Qrrq7bvWGktOZufdczrkzO2aFv/58a9+6B89zXddzPc/zfX+72+mbjaquFUWxLBs7hyGm94hcd+b53tpcGu5ud7C2251pbjVNM3R9b1lDguMAjOUCVAQIgmCqTkiIZJ/Ltu962UophMSLc4C2a3usjr/uz2hbbPVFUcxQY/qDI/2/RTeezLJs5rsuEL16lby7HjakvGN4OjnP84EZfbDXL9mbq/9iPiXjC1lZkYSFIaGUJklCCIHqQogLyVCPN42yvPk2/6osFVVVDcP8sfg+/zSvqgqHoMijgp2SwQB+gDhhJAwpjSFGFEVxHGMdzsIa2JamKaWR4zimaeZFUZblyMw5dEcJAFjFx2hGPC6KCZxMuffNQgp8pG3bU3nMwH6/B0NIQsc5YLzQgq7roHkk+a7kxZBdL9peyN8F49y2EPaxrvsH8zQoNFB1NJfP31Yv3lfPrssPN6Kuzsz1GE+3UPNurosvhvio8T3tyuKUjHkWkCjLMzSTMgaTmqaBnhAyzTI8cZwcjxU/pnXJmoqhkbNgQqBtXKaNrpumsVqtNFWDYLiMi8UiiigEI0GAQmEUBQRPCAdOFwNuwNhwDFBnaSrOnoH/4ZD/uhjTkADFlIaE5FnGGLt39K8T5tgO5jk7B5amUblsm5Q/AYDgOjvbsy5MAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/db5b73795778fac240b89db954ba6cd4/a805d/userright.webp 495w,\n/static/db5b73795778fac240b89db954ba6cd4/e020f/userright.webp 666w\"\n          sizes=\"(max-width: 666px) 100vw, 666px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/db5b73795778fac240b89db954ba6cd4/b3db0/userright.png 495w,\n/static/db5b73795778fac240b89db954ba6cd4/124dc/userright.png 666w\"\n          sizes=\"(max-width: 666px) 100vw, 666px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/db5b73795778fac240b89db954ba6cd4/124dc/userright.png\"\n          alt=\"google userright\"\n          title=\"google userright\"\n          src=\"/static/db5b73795778fac240b89db954ba6cd4/124dc/userright.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    \n  <figcaption class=\"gatsby-resp-image-figcaption\">google userright</figcaption>\n  </figure>\n      <br>\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n  \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cdb8a8e4febbe48927197054b4a7758e/54049/debugRun.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 492px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 33.13008130081301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABB0lEQVQY01VQDW+DIBTk//+6NpnLtK0giAKPD6vU2tjU3dY0Wy/wcgHu3j3YJZ+L4mO/3+92O/J+27bH44G9vfDHnlf/wLzR5VdVlmUjJT+dhmHodD+eh0ZIctTq1hlne3pKt3ewGLz3ARohBK95q1rUTmslldbaWVvXnMjfbrd5nqdpmi/z9QVmjCXnUkqHquJccGwhpFQgTdMYY4ri0zkHd3QBCSGkFxg06ICjEAOMx3G01hyOR/ikISEU9Kg555+EIXh4/C5wBnuwdV2XZbnOVyKKsLGROh/I604jMxJiwvv9vr6DdV0fY4QSI+GRtXYap+yzlbk+LaqNSqm+N85RSsP732/fJeOHZ5EctVsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/cdb8a8e4febbe48927197054b4a7758e/39d29/debugRun.webp 492w\"\n          sizes=\"(max-width: 492px) 100vw, 492px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/cdb8a8e4febbe48927197054b4a7758e/54049/debugRun.png 492w\"\n          sizes=\"(max-width: 492px) 100vw, 492px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/cdb8a8e4febbe48927197054b4a7758e/54049/debugRun.png\"\n          alt=\"debugRun\"\n          title=\"debugRun\"\n          src=\"/static/cdb8a8e4febbe48927197054b4a7758e/54049/debugRun.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    \n  <figcaption class=\"gatsby-resp-image-figcaption\">debugRun</figcaption>\n  </figure>\n      </p>\n<h3 id=\"step6-部署為網路應用程式\" style=\"position:relative;\"><a href=\"#step6-%E9%83%A8%E7%BD%B2%E7%82%BA%E7%B6%B2%E8%B7%AF%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F\" aria-label=\"step6 部署為網路應用程式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STEP.6 部署為網路應用程式</h3>\n<p>\n  <figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n  \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0888b33a9fcd9d448463e8151fa0f795/499f1/deployAppScript.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 633px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 57.17171717171718%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABM0lEQVQoz4VS2W6DMBDk/z8uVSMFnsJlY0jwhQ3IxkA7JFHUKqQdAQ+7O5rZWSJCyo/DIU4SY8yyLN5551wIYZqmdV2//kTEaMUqlmdZURSUUsYYKUlZlFmaKdXN8+y9n24IL4iaSyOVzLKMEJKm6bW9UkLjU3z8PCZJcrlcrbUwJYSQL4jAkVKhjaFt1Nje9hitWZ3nObp9P0BkGHqtdfcbUVPXWBKuuk4LLicftFIo4oGdPC+whTH9PC87O4sbnk5Qatv2fD4jBc63+jiOKGL5HfKdo5TCV9zI0ERwtKqEUk/O/2Qkh2spIZqibOsmPcWo3oNF2G/JCOPufxNBPEIMUg1cLBtmvLs3/0HmHMphCjgsGo/pdd14b/6Wp+2HMs7BOTe6G4T01gbntHXKILMd/jfLhHN/JxLxJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/0888b33a9fcd9d448463e8151fa0f795/a805d/deployAppScript.webp 495w,\n/static/0888b33a9fcd9d448463e8151fa0f795/3d6ad/deployAppScript.webp 633w\"\n          sizes=\"(max-width: 633px) 100vw, 633px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/0888b33a9fcd9d448463e8151fa0f795/b3db0/deployAppScript.png 495w,\n/static/0888b33a9fcd9d448463e8151fa0f795/499f1/deployAppScript.png 633w\"\n          sizes=\"(max-width: 633px) 100vw, 633px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/0888b33a9fcd9d448463e8151fa0f795/499f1/deployAppScript.png\"\n          alt=\"google deployAppScript\"\n          title=\"google deployAppScript\"\n          src=\"/static/0888b33a9fcd9d448463e8151fa0f795/499f1/deployAppScript.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    \n  <figcaption class=\"gatsby-resp-image-figcaption\">google deployAppScript</figcaption>\n  </figure>\n      <br>\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n  \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/51a32d2ea4472cf10763e6e34553a900/04da6/adjustAppscript.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 562px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 87.07070707070707%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAABZUlEQVQ4y42TS26DMBBAc+nuep8ueopuknYTEhUawE0IBGwgkqEEMDZgOoSq+VmCJyHZgx5jZjwz94r9Le4Ys8GhlFZVVV8hhChVFEWRJInneX+y4zgQ6rrOcw+E4OFzGJNOhZQS0tzLbduuVmvLtJzzeQkhrZRKv2may7EHWcpWWy4PB78bQylL0zSDAP+kKWMMtu0DoEFcLSeURmGE/YBXvJebyTK80XUDIbR39nF8/C/P1H+2bfvLMHT9Exa+70dRpCyZWoacto02umFbaA2VtxClyWP+ezk/9zkkoe8HcRyH0ChMoigWtZhabeizpmkrTVvM5++LD8Mw4Djjcp7nEM1SyopTFIaY9KRpOq3PeQ4pSiHLupM3l3FM3u6cri7eLPn0Uj2/8k3Q0iPBOBSiIUf26N9nzrI0OQkUlFvCsoKzfngKzjmruLgFBg7u30UG4G5sv23XQe4OFrDrnwFbxTDtvxtkto7SbvKtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/51a32d2ea4472cf10763e6e34553a900/a805d/adjustAppscript.webp 495w,\n/static/51a32d2ea4472cf10763e6e34553a900/1464b/adjustAppscript.webp 562w\"\n          sizes=\"(max-width: 562px) 100vw, 562px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/51a32d2ea4472cf10763e6e34553a900/b3db0/adjustAppscript.png 495w,\n/static/51a32d2ea4472cf10763e6e34553a900/04da6/adjustAppscript.png 562w\"\n          sizes=\"(max-width: 562px) 100vw, 562px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/51a32d2ea4472cf10763e6e34553a900/04da6/adjustAppscript.png\"\n          alt=\"adjustAppscript\"\n          title=\"adjustAppscript\"\n          src=\"/static/51a32d2ea4472cf10763e6e34553a900/04da6/adjustAppscript.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    \n  <figcaption class=\"gatsby-resp-image-figcaption\">adjustAppscript</figcaption>\n  </figure>\n      <br>\n<figure class=\"gatsby-resp-image-figure\" style=\"margin: 7vw 0;\">\n  \n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6caa881f1c5fbea5f847917154930621/655e2/AppScriptapi.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 624px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 56.56565656565656%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABHklEQVQoz42R206DQBCGff+nMRovvNJobNTGKw9lMewBKmBg2bOwsEvdVmOqUu2XP3Mz8yWTmQNCCMZ4WNMrJY1RoWqjvXerld/OOHprbZ7nCCGy4eBDDqO0YQAkIIahIpT2/bCaoiiKHzIahnG0Bc/P5esVLy6b5UWVnZl6Nsh5L27X4deDetohu9Fqgh4P8eIEPhwn90fL51NdzUZ959U8xMkbbxaTMvbOcS4QJGARh1aaFrZ3IUK+Kd0p3UrVatPtkL1nDY0ATmAJYhRHIIoiCFFVVbSmdU3LsmSMTcvh1l3b1lQxOTBuGhqEWmuzz8Gwc852XZ6/jOsP/cWEHFYSQvANYgv5iyzLwvw3OdkAIUz+48v8lAPp3pAt3gH0MlriJl5pXQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <picture>\n        <source\n          srcset=\"/static/6caa881f1c5fbea5f847917154930621/a805d/AppScriptapi.webp 495w,\n/static/6caa881f1c5fbea5f847917154930621/f2984/AppScriptapi.webp 624w\"\n          sizes=\"(max-width: 624px) 100vw, 624px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/6caa881f1c5fbea5f847917154930621/b3db0/AppScriptapi.png 495w,\n/static/6caa881f1c5fbea5f847917154930621/655e2/AppScriptapi.png 624w\"\n          sizes=\"(max-width: 624px) 100vw, 624px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n          src=\"/static/6caa881f1c5fbea5f847917154930621/655e2/AppScriptapi.png\"\n          alt=\"AppScriptapi\"\n          title=\"AppScriptapi\"\n          src=\"/static/6caa881f1c5fbea5f847917154930621/655e2/AppScriptapi.png\"\n        />\n      </picture>\n      </span>\n  </span>\n  \n  </a>\n    \n  <figcaption class=\"gatsby-resp-image-figcaption\">AppScriptapi</figcaption>\n  </figure>\n      </p>\n<p>把上面的 URL 複製起來，這就是我們 API 的 URL。</p>\n<h3 id=\"step7-建立-html-串接資料\" style=\"position:relative;\"><a href=\"#step7-%E5%BB%BA%E7%AB%8B-html-%E4%B8%B2%E6%8E%A5%E8%B3%87%E6%96%99\" aria-label=\"step7 建立 html 串接資料 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>STEP.7 建立 html 串接資料</h3>\n<p>快速簡單的建出了一個網頁，點擊下方的送出，然後 call send function 非同步送出資料，然後成功再回傳給使用者感謝，</p>\n<p>這個頁面的 javasctipt 都在處理 沒填寫資料要被擋，還有組出訂購的品量數量。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">上半部為觸發call <span class=\"token keyword\">function</span>\n<span class=\"token operator\">...</span>\n      <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token string\">'name'</span> <span class=\"token operator\">:</span> name<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'phone'</span><span class=\"token operator\">:</span>phone<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'time'</span><span class=\"token operator\">:</span> filltime<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'order'</span><span class=\"token operator\">:</span> order<span class=\"token punctuation\">,</span>\n          <span class=\"token string\">'price'</span><span class=\"token operator\">:</span> price<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token function\">send</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">function</span> <span class=\"token function\">send</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        type<span class=\"token operator\">:</span> <span class=\"token string\">\"get\"</span><span class=\"token punctuation\">,</span>\n        url<span class=\"token operator\">:</span> <span class=\"token string\">\"https://script.google.com/macros/s/AKfycbz3fU3FVDmIQehtWX6ecKuV_A67lE64FEQ-ekmOZ_jZDyY96z0/exec\"</span><span class=\"token punctuation\">,</span>\n        data<span class=\"token operator\">:</span> data<span class=\"token punctuation\">,</span>\n        dataType<span class=\"token operator\">:</span> <span class=\"token string\">\"JSON\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'感謝您的訂購！！'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://work.ianccy.com/%E7%82%B8%E9%9B%9E%E8%A8%82%E8%B3%BC\" title=\"鹹酥雞訂購 範例網頁\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">鹹酥雞訂購 範例網頁</a></p>\n<p><a href=\"https://docs.google.com/spreadsheets/d/1JbXssixJaqTL_BMgnmOiMxLyAZm0jOkw173VdewqO9c/edit#gid=0\" title=\"鹹酥雞訂購 Excel\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">鹹酥雞訂購 Excel</a></p>\n<p><a href=\"https://github.com/Ianpig/work/blob/master/googleform.md\" title=\"google form api html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">詳細的 code HTML Javasctipt + Appscript code</a></p>\n<p>剩下部份就客戶讀取、取消訂單，最後連結是進階處理。</p>\n<p>總結一下步驟:<br>\n建立 excel、appscript -> 編輯 appscript -> 部署公開串接 -> 網頁前端串接 api ->>> over</p>\n<h2 id=\"使用心得\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97\" aria-label=\"使用心得 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用心得</h2>\n<p>目前服務的公司也經常使用 google excel api，假設填表資料需要分享觀看、編輯，也不希望合作夥伴觀看公司後台，通常就會使用 google excel 來處理填表，優點就是創立非常快速、不需要後端幫忙，只要前端處理 css + html + javascript 大概 2 小時可以搞定。</p>\n<ul>\n<li>接續文章: <a href=\"/googleformadv/\" title=\"客戶讀取、取消訂單\">客戶讀取、取消訂單</a></li>\n</ul>","frontmatter":{"title":"Google sheet 試算表表單串接api","date":"February 08, 2018","description":"要用到活動或是問卷，相信大家最常會用到google form，非常快速的創出填表功能，但google form存在許多限制，google analytics轉換目標也不能設定，都可以用google excel的api來解決。","categories":"javascript","tags":["google_form"],"thumbnail":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+klEQVQoz2P4jwG+fft2+fLl27dvnzlzBsi4dPHihw8fgOL//v1DU8nw+/cvIPj//y+Q8/fPn39/fv36+ePt27ePHz++efPmtatXHj5+9unHrx9////9C9SMop9hSk9LcZDmghyL/f2B9/ZU3thR8uzaBojc+3dv582cuWvtkj0rp+9YN2/q3Nl3Hz0B2QFzAsPu5V1VthxF+gyFhgyzEsWvrQ17eHYRRO7r52+n9mxflW87y190R6HeslKH+3dugNz/9y9U89MLq7Y1Obb7iU0K5Ozw4LmwLOT89l645qPrZs5N0e3zk53hJ7Su0PrD+9fInme4c2bZkaWxB5Zk395ev7fX5/TyyMt7J0Hkbt+/P31iz5LKiLmpZmurg6cX+Ny8ewfkbLjN3z+//vT65vePD399fXHj8tErp3Z8+/gCIvfl69db9x68fvH848sHb968PXzs2OevX1FsBgbhz99Qk96///T1+y+INEQFMPwh9vz8+fPz589wKYgsAzAO37x98+sXMMZ+AyPj958/P4Hs33/A6Pfbd++/fvsGZEBE4FK/f/8Baf7z8wc89EgFDMdvvdpy9vGO80+3oyKgyMGrz3deeLLt/BM0qa1nnxy6/uLP338MZ++/2335+f6rL/ahIqDI6TtvDl5/ufcKutSeK89P3H4N1AwAMURntzW2wqoAAAAASUVORK5CYII=","aspectRatio":1.7258883248730965,"src":"/static/bf296d6e823a934526cab91eb6eaacae/ee604/%E7%82%B8%E9%9B%9Edemo.png","srcSet":"/static/bf296d6e823a934526cab91eb6eaacae/c972b/%E7%82%B8%E9%9B%9Edemo.png 340w,\n/static/bf296d6e823a934526cab91eb6eaacae/27625/%E7%82%B8%E9%9B%9Edemo.png 680w,\n/static/bf296d6e823a934526cab91eb6eaacae/ee604/%E7%82%B8%E9%9B%9Edemo.png 800w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"timeToRead":7,"parent":{"__typename":"File","modifiedTime":"2021-05-16T08:19:40.133Z"}}},"pageContext":{"slug":"/2018-02-googleformapi/","previous":{"fields":{"slug":"/2018-01-whatseo/"},"frontmatter":{"title":"SEO優化 google教學guideline介紹","tags":["seo"]}},"next":{"fields":{"slug":"/2018-03-interview/"},"frontmatter":{"title":"前端工程師面試心得 | Frontend Engineer interview","tags":["javascript","frontend"]}}}},"staticQueryHashes":["1481458783","63159454"]}