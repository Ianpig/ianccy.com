{"componentChunkName":"component---src-templates-blog-post-js","path":"/googleformapi/","result":{"data":{"site":{"siteMetadata":{"title":"Ian Chu","author":"Ian Chu","siteUrl":"https://ianccy.com","social":{"facebook":"chu1228"}}},"markdownRemark":{"id":"24d5d72c-8c8d-53da-a8b0-16cb9ab28ccc","fields":{"slug":"/2018-02-googleformapi/"},"headings":[{"value":"google excel 試算表 實作功能","id":null,"depth":2},{"value":"google sheet method 介紹","id":null,"depth":2},{"value":"STEP.1 打開 google 雲端硬碟 建立 google excel、建立 google AppScript","id":null,"depth":3},{"value":"STEP.2 選擇剛剛創立的 google excel 網址參數","id":null,"depth":3},{"value":"STEP.3 打開 AppScript 加上剛剛複製的編碼 以及 javascript","id":null,"depth":3},{"value":"STEP.4 建立 debug.gs 來測試剛剛的 建立資料","id":null,"depth":3},{"value":"STEP.5 編輯 允許權限","id":null,"depth":3},{"value":"STEP.6 部署為網路應用程式","id":null,"depth":3},{"value":"STEP.7 建立 html 串接資料","id":null,"depth":3},{"value":"使用心得","id":null,"depth":2}],"excerpt":"要用到活動或是問卷，相信大家最常會用到 google form，非常快速的創出填表功能，但 google form 存在許多限制，我沒辦法創立特別的欄位，沒辦法做出一個複雜訂餐表單，表單長太醜(痾...其實我對 google 表單設定不太熟悉)。 或是不希望讓使用者點擊網址離開才能填表。最後網站只能鑲上 google…","html":"<p>要用到活動或是問卷，相信大家最常會用到 google form，非常快速的創出填表功能，但 google form 存在許多限制，我沒辦法創立特別的欄位，沒辦法做出一個複雜訂餐表單，表單長太醜(痾...其實我對 google 表單設定不太熟悉)。</p>\n<p>或是不希望讓使用者點擊網址離開才能填表。最後網站只能鑲上 google form 的 iframe 又無法追蹤填表操作動作，google analytics 轉換目標也不能設定。上面這些問題都可以用 google excel 的 api 來解決。</p>\n<!--- ![炸雞demo](../images/炸雞demo.png \"炸雞demo\") --->\n<p><a href=\"https://work.ianccy.com/%E7%82%B8%E9%9B%9E%E8%A8%82%E8%B3%BC\" title=\"炸雞訂購網頁\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">炸雞訂購網頁</a></p>\n<ul>\n<li>延伸文章: <a href=\"/googleformadv/\" title=\"客戶讀取、取消訂單\">客戶讀取、取消訂單</a></li>\n</ul>\n<h2>google excel 試算表 實作功能</h2>\n<p>這邊要利用 google 試算表 增加資料 撈取 來實作一個網頁，簡單的鹹酥雞訂餐服務，老闆也可以修改處理狀態，讓顧客可以再取餐前查詢，到底老闆有沒有幫我做好鹹酥雞勒，還是放生我了 XD。</p>\n<p>只需要搭配 html + css + javascript。\n（因為我家附近有間鹹酥雞，每次買都實在等太久，所以才想玩玩看。）</p>\n<h2>google sheet method 介紹</h2>\n<p>google 官方文件 <a href=\"https://developers.google.com/apps-script/reference/spreadsheet/sheet\" title=\"google sheet api\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">spreadsheet method</a>，裡面有非常詳盡的介紹，包括可以讀取欄位、讀取資料、排序資料、插入資料等等的功能，其實某方面來說算是功能齊全的類資料庫了。有興趣可以點開來看裡面文件。</p>\n<p>文件裡面 method 一大堆，還是直接實作比較快。</p>\n<h3>STEP.1 打開 google 雲端硬碟 建立 google excel、建立 google AppScript</h3>\n<p><img src=\"../images/creatExcel.png\" alt=\"google creatExcel\" title=\"google creatExcel\"></p>\n<p><img src=\"../images/creatAppScript.png\" alt=\"google creatAppScript\" title=\"google creatAppScript\"></p>\n<h3>STEP.2 選擇剛剛創立的 google excel 網址參數</h3>\n<p>xxxxxxxxxxx/edit，/edit 前面這段參數\n<a href=\"https://docs.google.com...\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://docs.google.com...</a><mark>1JbXssixJaqTL_BMgnmOiMxLyAZm0jOkw173VdewqO9c1</mark>/edit#gid=0</p>\n<h3>STEP.3 打開 AppScript 加上剛剛複製的編碼 以及 javascript</h3>\n<p>首先在 myFunction 上加入參數，因為之後要透過 call 這個 api 帶入資料，下面是預期會帶入的物件名稱 name、phone、time、order、price。這些都可以根據你想要帶的資料名稱變化，也可以刪減。</p>\n<p>後面是依靠 google sheet 的 method 來選取表單，後面貼上你剛剛 excel 的編碼，再來是用.getSheets()[0]來選取第 1 個工作表單。這樣就成功的選取到這整個 table 了。</p>\n<p>這邊先處理接到值傳進來先命名，再來選取你要填入的 google excel 編碼、excel tab。</p>\n<p>ps.這邊用的是 doGet function，代表這個 function 會被 api 的 Get 調用到，也可以用 doPost，但是你串接 api 就要改用 Post。</p>\n<pre><code class=\"language-javascript\">function doGet(e) {\n  //接帶入值 轉為變數    - 可根據需求修改\n  var params = e.parameter;\n  var name = params.name;\n  var phone = params.phone;\n  var time = params.time;\n  var order = params.order;\n  var price = params.price;\n\n  //這是選擇這個google excel\n  var SpreadSheet = SpreadsheetApp.openById(\"貼上你剛剛複製的編碼\");\n  //取得 第一個表單\n  var Sheet = SpreadSheet.getSheets()[0];\n\n  ...\n}\n</code></pre>\n<p>這邊比較搞剛的是要處理訂單編號，以便於日後我們比對資料方便，剩下最重要的塞剛剛帶進來的值。就完成的簡單的插入資料 function 了！</p>\n<pre><code class=\"language-javascript\">  ...\n  //取得 LastRow = 有資料的最後一行的位置\n  var LastRow = Sheet.getLastRow();\n\n\n  // 這邊是處理訂單編號 - 我先選取 有資料最後一行 的 第6欄\n  var range = Sheet.getRange(LastRow, 6);\n  // 創立訂單編號  (最後一行的第六欄 +1)\n  var orderNum = parseFloat(range.getValues())+1;\n  //若最後一行是第1行 需要轉為訂單編號1\n  if(LastRow == 1){\n    orderNum = 1;\n  }\n\n  //開始寫入資料 同樣是 getRange 選擇 (行,欄) setValue 帶入值name phone time order price values進來\n  Sheet.getRange(LastRow+1, 1).setValue(name);\n  Sheet.getRange(LastRow+1, 2).setValue(phone);\n  Sheet.getRange(LastRow+1, 3).setValue(time);\n  Sheet.getRange(LastRow+1, 4).setValue(order);\n  Sheet.getRange(LastRow+1, 5).setValue(price);\n  Sheet.getRange(LastRow+1, 6).setValue(orderNum);\n\n  //寫入結束後傳回true\n  return ContentService.createTextOutput(true);\n}\n</code></pre>\n<h3>STEP.4 建立 debug.gs 來測試剛剛的 建立資料</h3>\n<pre><code class=\"language-javascript\">//call\nfunction debug() {\n    var Result = doGet({\n        parameter: {\n            name: '測試先生',\n            phone: '0912345678',\n            time: '2018/02/10 22:46:00',\n            order: '鹹酥雞 * 1',\n            price: '40'\n        }\n    });\n    Logger.log('Result: %s', Result);\n}\n</code></pre>\n<h3>STEP.5 編輯 允許權限</h3>\n<p>ㄧ路點選允許到底即可</p>\n<p>這邊需要點進階 前往 xxx 不安全\n<img src=\"../images/userright.png\" alt=\"google userright\" title=\"google userright\">\n<img src=\"../images/debugRun.png\" alt=\"debugRun\" title=\"debugRun\"></p>\n<h3>STEP.6 部署為網路應用程式</h3>\n<p><img src=\"../images/deployAppScript.png\" alt=\"google deployAppScript\" title=\"google deployAppScript\">\n<img src=\"../images/adjustAppscript.png\" alt=\"adjustAppscript\" title=\"adjustAppscript\">\n<img src=\"../images/AppScriptapi.png\" alt=\"AppScriptapi\" title=\"AppScriptapi\"></p>\n<p>把上面的 URL 複製起來，這就是我們 API 的 URL。</p>\n<h3>STEP.7 建立 html 串接資料</h3>\n<p>快速簡單的建出了一個網頁，點擊下方的送出，然後 call send function 非同步送出資料，然後成功再回傳給使用者感謝，</p>\n<p>這個頁面的 javasctipt 都在處理 沒填寫資料要被擋，還有組出訂購的品量數量。</p>\n<pre><code class=\"language-javascript\">上半部為觸發call function\n...\n      var data = {\n          'name' : name,\n          'phone':phone,\n          'time': filltime,\n          'order': order,\n          'price': price,\n      }\n      send(data)\n    }\n    function send(data){\n      $.ajax({\n        type: \"get\",\n        url: \"https://script.google.com/macros/s/AKfycbz3fU3FVDmIQehtWX6ecKuV_A67lE64FEQ-ekmOZ_jZDyY96z0/exec\",\n        data: data,\n        dataType: \"JSON\",\n        success: function (response) {\n          alert('感謝您的訂購！！');\n        }\n      });\n    }\n</code></pre>\n<p><a href=\"https://work.ianccy.com/%E7%82%B8%E9%9B%9E%E8%A8%82%E8%B3%BC\" title=\"鹹酥雞訂購 範例網頁\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">鹹酥雞訂購 範例網頁</a></p>\n<p><a href=\"https://docs.google.com/spreadsheets/d/1JbXssixJaqTL_BMgnmOiMxLyAZm0jOkw173VdewqO9c/edit#gid=0\" title=\"鹹酥雞訂購 Excel\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">鹹酥雞訂購 Excel</a></p>\n<p><a href=\"https://github.com/Ianpig/work/blob/master/googleform.md\" title=\"google form api html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">詳細的 code HTML Javasctipt + Appscript code</a></p>\n<p>剩下部份就客戶讀取、取消訂單，最後連結是進階處理。</p>\n<p>總結一下步驟:\n建立 excel、appscript -> 編輯 appscript -> 部署公開串接 -> 網頁前端串接 api ->>> over</p>\n<h2>使用心得</h2>\n<p>目前服務的公司也經常使用 google excel api，假設填表資料需要分享觀看、編輯，也不希望合作夥伴觀看公司後台，通常就會使用 google excel 來處理填表，優點就是創立非常快速、不需要後端幫忙，只要前端處理 css + html + javascript 大概 2 小時可以搞定。</p>\n<ul>\n<li>接續文章: <a href=\"/googleformadv/\" title=\"客戶讀取、取消訂單\">客戶讀取、取消訂單</a></li>\n</ul>","frontmatter":{"title":"Google sheet 試算表表單串接api","date":"February 08, 2018","description":"要用到活動或是問卷，相信大家最常會用到google form，非常快速的創出填表功能，但google form存在許多限制，google analytics轉換目標也不能設定，都可以用google excel的api來解決。","categories":"javascript","tags":["google_form"],"thumbnail":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+klEQVQoz2P4jwG+fft2+fLl27dvnzlzBsi4dPHihw8fgOL//v1DU8nw+/cvIPj//y+Q8/fPn39/fv36+ePt27ePHz++efPmtatXHj5+9unHrx9////9C9SMop9hSk9LcZDmghyL/f2B9/ZU3thR8uzaBojc+3dv582cuWvtkj0rp+9YN2/q3Nl3Hz0B2QFzAsPu5V1VthxF+gyFhgyzEsWvrQ17eHYRRO7r52+n9mxflW87y190R6HeslKH+3dugNz/9y9U89MLq7Y1Obb7iU0K5Ozw4LmwLOT89l645qPrZs5N0e3zk53hJ7Su0PrD+9fInme4c2bZkaWxB5Zk395ev7fX5/TyyMt7J0Hkbt+/P31iz5LKiLmpZmurg6cX+Ny8ewfkbLjN3z+//vT65vePD399fXHj8tErp3Z8+/gCIvfl69db9x68fvH848sHb968PXzs2OevX1FsBgbhz99Qk96///T1+y+INEQFMPwh9vz8+fPz589wKYgsAzAO37x98+sXMMZ+AyPj958/P4Hs33/A6Pfbd++/fvsGZEBE4FK/f/8Baf7z8wc89EgFDMdvvdpy9vGO80+3oyKgyMGrz3deeLLt/BM0qa1nnxy6/uLP338MZ++/2335+f6rL/ahIqDI6TtvDl5/ufcKutSeK89P3H4N1AwAMURntzW2wqoAAAAASUVORK5CYII=","aspectRatio":1.7258883248730965,"src":"/static/bf296d6e823a934526cab91eb6eaacae/ee604/%E7%82%B8%E9%9B%9Edemo.png","srcSet":"/static/bf296d6e823a934526cab91eb6eaacae/c972b/%E7%82%B8%E9%9B%9Edemo.png 340w,\n/static/bf296d6e823a934526cab91eb6eaacae/27625/%E7%82%B8%E9%9B%9Edemo.png 680w,\n/static/bf296d6e823a934526cab91eb6eaacae/ee604/%E7%82%B8%E9%9B%9Edemo.png 800w","sizes":"(max-width: 800px) 100vw, 800px"}}}},"timeToRead":5,"parent":{"__typename":"File","modifiedTime":"2021-05-16T08:19:40.133Z"}}},"pageContext":{"slug":"/2018-02-googleformapi/","previous":{"fields":{"slug":"/2018-01-whatseo/"},"frontmatter":{"title":"SEO優化 google教學guideline介紹","tags":["seo"]}},"next":{"fields":{"slug":"/2018-03-interview/"},"frontmatter":{"title":"前端工程師面試心得 | Frontend Engineer interview","tags":["javascript","frontend"]}}}},"staticQueryHashes":["1481458783","63159454"]}