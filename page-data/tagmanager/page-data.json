{"componentChunkName":"component---src-templates-blog-post-js","path":"/tagmanager/","result":{"data":{"site":{"siteMetadata":{"title":"Ian Chu","author":"Ian Chu","siteUrl":"https://ianccy.com","social":{"facebook":"chu1228"}}},"markdownRemark":{"id":"fb04b6ec-addd-5830-8fc2-39e2a2a472c0","fields":{"slug":"/2018-08-tagmanager/"},"headings":[{"value":"建立帳戶 埋設 Tag Manager traking code","id":null,"depth":2},{"value":"Tag manager 設定 google analytics tracking code","id":null,"depth":2},{"value":"進入代碼區塊 點擊新增","id":null,"depth":4},{"value":"選擇 google analytics","id":null,"depth":4},{"value":"點選上半部變數區塊 => 加入你 google analytics 的追蹤碼 UA-xxxxxxxx-x","id":null,"depth":4},{"value":"點選下半部觸發區塊 => 選擇 All page view","id":null,"depth":4},{"value":"點擊右上角提交","id":null,"depth":4},{"value":"首先先點擊左邊選單的 變數，讓我們後面可以取用點擊連結的 URL","id":null,"depth":4},{"value":"點擊左邊選單的 觸發條件 => 新增 => 觸發條件設定 => 點選連結","id":null,"depth":4},{"value":"選擇內建變數","id":null,"depth":4},{"value":"選擇 click target => 儲存","id":null,"depth":4},{"value":"點擊左邊選單的 代碼 => 選擇 google analytics => 點擊上半部區塊代碼設定","id":null,"depth":4},{"value":"點擊下半部區塊代碼設定 => 選擇剛剛設定好的觸發條件","id":null,"depth":4},{"value":"點擊提交","id":null,"depth":4},{"value":"點擊預覽模式 => 進入網頁測試","id":null,"depth":4},{"value":"Tag Manager 結論重點","id":null,"depth":2}],"excerpt":"Tag manager 是一個強大的程式碼管理容器，一個代碼管理中心的概念，提醒一下它並不是取代 google analytics，而是涵蓋著處理各種代碼的設定，包括 google analytics 以及各種 tracking code、或是 html 等等。功能非常的強大，因此寫錯 script 或 css…","html":"<p>Tag manager 是一個強大的程式碼管理容器，一個代碼管理中心的概念，提醒一下它並不是取代 google analytics，而是涵蓋著處理各種代碼的設定，包括 google analytics 以及各種 tracking code、或是 html 等等。功能非常的強大，因此寫錯 script 或 css 就可能讓你網站出問題。</p>\n<!--- ![google tagmanager](../images/tagmanager.png \"google tagmanager\") --->\n<p>以往的埋設追蹤碼都是增加一段 script，但是當你有用了 tag manager，這段 script 可以轉由 tag manager 幫你引入，由 tag manager 來控管 tracking code，假設你是行銷人員，就不用在請程式人員幫你埋碼了。</p>\n<pre><code class=\"language-javascript\">// 傳統 google analytics tacking code\n&#x3C;script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\nm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\nga('create','UA-xxxxxxxxxx-1','auto');ga('send','pageview');&#x3C;/script>\n\n// 以上這段code會變成你在tag manager 選擇google analytics，貼上UA-xxxxxxxxxxx-1。\n// 如果沒有支援就改成用html方式引入code\n</code></pre>\n<h2>建立帳戶 埋設 Tag Manager traking code</h2>\n<p>進入 <a href=\"https://tagmanager.google.com/\" title=\"tag manager\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">google tag manager</a> 網站註冊登入，點選建立帳戶，接下來會彈出一段程式碼。</p>\n<pre><code class=\"language-javascript\">&#x3C;!DOCTYPE html>\n\n...\n// 將這段script 放到網站的&#x3C;head>前面\n&#x3C;!-- Google Tag Manager -->\n&#x3C;script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&#x26;l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','GTM-你的追蹤碼');&#x3C;/script>\n&#x3C;!-- End Google Tag Manager -->\n&#x3C;head>\n...\n</code></pre>\n<p>恭喜你，基本上後面動作你就不需要動到 html 了。除非要做 data layer 的設定。\n<a href=\"https://developers.google.com/tag-manager/devguide\" title=\"tag manager data layer\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">tag manager data layer 說明文件</a></p>\n<h2>Tag manager 設定 google analytics tracking code</h2>\n<p>tag manager 有整合進 google analytics 的設定，</p>\n<h4>進入代碼區塊 點擊新增</h4>\n<p><img src=\"../images/tagadd.png\" alt=\"google tagmanager add\" title=\"google tagmanager add\"></p>\n<h4>選擇 google analytics</h4>\n<p><img src=\"../images/tagsetga.png\" alt=\"google tagmanager tag set ga\" title=\"google tagmanager tag set ga\"></p>\n<h4>點選上半部變數區塊 => 加入你 google analytics 的追蹤碼 UA-xxxxxxxx-x</h4>\n<p><img src=\"../images/tagvar.png\" alt=\"google tagmanager tag tag var\" title=\"google tagmanager tag var\"></p>\n<h4>點選下半部觸發區塊 => 選擇 All page view</h4>\n<p><img src=\"../images/tagtrigger.png\" alt=\"google tagmanager tag trigger\" title=\"google tagmanager tag trigger\"></p>\n<h4>點擊右上角提交</h4>\n<p><img src=\"../images/tagsubmit.png\" alt=\"google tagmanager tag submit\" title=\"google tagmanager tag submit\"></p>\n<p>記住一個重點，tag manager 每個改動都需要你點擊提交，才算是真正送出修改，如果要先觀看有沒有問題，可以點擊預覽，進入有埋設 tag manager 的網站，下方會跳出介面，會列出有在執行項目。</p>\n<p>以上就是成功用 tag manager 埋好了 google analytics，那接下來開始介紹一個強大的功能，直接靠 tag manager 建立事件。我要追蹤的是 click target=\"_blank\"的連結(因為有處理過會把外部連結設為開新視窗)。</p>\n<h4>首先先點擊左邊選單的 變數，讓我們後面可以取用點擊連結的 URL</h4>\n<p><img src=\"../images/tagopenvar.png\" alt=\"google tagmanager tag openvar\" title=\"google tagmanager openvar\"></p>\n<h4>點擊左邊選單的 觸發條件 => 新增 => 觸發條件設定 => 點選連結</h4>\n<p><img src=\"../images/tagtrigerset.png\" alt=\"google tagmanager tag trigerset\" title=\"google tagmanager trigerset\"></p>\n<h4>選擇內建變數</h4>\n<p><img src=\"../images/tagdefault.png\" alt=\"google tagmanager tag default\" title=\"google tagmanager tag default\"></p>\n<h4>選擇 click target => 儲存</h4>\n<p><img src=\"../images/tagtarget.png\" alt=\"google tagmanager tag target\" title=\"google tagmanager tag target\"></p>\n<h4>點擊左邊選單的 代碼 => 選擇 google analytics => 點擊上半部區塊[代碼設定]</h4>\n<p><img src=\"../images/tagevent.png\" alt=\"google tagmanager event setting\" title=\"google tagmanager event setting\"></p>\n<h4>點擊下半部區塊[代碼設定] => 選擇剛剛設定好的觸發條件</h4>\n<p><img src=\"../images/tagevent2.png\" alt=\"google tagmanager event setting 2\" title=\"google tagmanager event setting 2\"></p>\n<h4>點擊提交</h4>\n<h4>點擊預覽模式 => 進入網頁測試</h4>\n<p>首先點擊網頁上的開新視窗連結，在觀察下方的介面有沒有 fired on this page\n<img src=\"../images/tagtest.png\" alt=\"google tagmanager tag test\" title=\"google tagmanager tag test\"></p>\n<p>woooooooo，這樣就完成了一個 google analytics 的事件追蹤設定。</p>\n<h2>Tag Manager 結論重點</h2>\n<p>tag manager 核心邏輯大概是 變數、觸發條件、代碼。變數可以把它看作設定的某個數值，觸發條件則是觸發的原因，代碼則是整合觸發條件還有變數。每個代碼都必須要有觸發條件，例如 google analytic 就是在網頁瀏覽觸發，要讓程式碼知道你這段代碼要在什麼時候執行。至於變數則是沒有一定要加，視狀況而定。</p>\n<p>另外介紹目前公司針對不同客戶的客製化代碼，都是在 tag manager 設定的。例如某個客戶要客製化的 html，就用代碼判斷這個客戶的網址，利用代碼引入 javaScipt，動態的載入 html。</p>\n<p>最後想說 tag manager 對於行銷人來說，似乎有點複雜，以前我擔任行銷時，其實也不太會用，用得好的話需要有 html、JavaScript 邏輯，有些公司甚至是前端工程師專門維運 tag manager 的，所以如果你覺得很難理解或使用應該是滿正常的，但如果你會用的話，恭喜你，tag manager 會是非常厲害的求職技能。</p>\n<p>以上是 tag manager 的介紹，關於設定流程有問題歡迎留言。</p>","frontmatter":{"title":"Google Tag Manager tracking code 安裝追蹤碼","date":"August 26, 2018","description":"Google Tag manager 是一個強大的程式碼管理容器，一個代碼管理中心的概念，涵蓋著處理各種代碼的設定。接下來就開始介紹功能，靠tag manager建立事件。我要追蹤的是click的連結。","categories":"marketing","tags":["tag_manager","google_analytics"],"thumbnail":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAA4UlEQVQoz6VSSw6CMBDljJ7CvS7cegN3xiO4dWliWBMSSKgoYcGvCZDSNMSAoXyKLSYV3SGTpp3X6etM31TpZ5jyXtgwJpMlR/DZ5wY2mHQk7EfHRGav6HYOzStBb9t2Quao7Nb3enl+ro4Uxlnge2maZlkGIQyCACHEnTzPwzD0fZ9DHsIYJ0lSFIWCKNuY5WKPt6caYXKzbQCuAABVVU3TJIRYlmUYRhzHfNNxHNd1NU3TdV2QefYI14fLo2qYfA+fKaWyvKZpxtVKqEid2UibH2F+9PtqFYcd+6tVcz7JC9FpQhumICOXAAAAAElFTkSuQmCC","aspectRatio":2.035928143712575,"src":"/static/c964d1cfd4f170bf443f61ca8da3d695/20530/tagmanager.png","srcSet":"/static/c964d1cfd4f170bf443f61ca8da3d695/c972b/tagmanager.png 340w,\n/static/c964d1cfd4f170bf443f61ca8da3d695/27625/tagmanager.png 680w,\n/static/c964d1cfd4f170bf443f61ca8da3d695/20530/tagmanager.png 785w","sizes":"(max-width: 785px) 100vw, 785px"}}}},"timeToRead":4,"parent":{"__typename":"File","modifiedTime":"2021-05-16T08:19:40.138Z"}}},"pageContext":{"slug":"/2018-08-tagmanager/","previous":{"fields":{"slug":"/2018-08-jsproto/"},"frontmatter":{"title":"JavaScript Prototype 繼承、原型鏈 Prototype chain","tags":["javascript","prototype"]}},"next":{"fields":{"slug":"/2018-09-postmessage/"},"frontmatter":{"title":"HTML postMessage iframe and open window 跨視窗傳訊用法","tags":["javascript"]}}}},"staticQueryHashes":["1481458783","63159454"]}