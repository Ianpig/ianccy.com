{"componentChunkName":"component---src-templates-blog-post-js","path":"/reactpuppeteer/","result":{"data":{"site":{"siteMetadata":{"title":"Ian Chu","author":"Ian Chu","siteUrl":"https://ianccy.com","social":{"facebook":"chu1228"}}},"markdownRemark":{"id":"ee7077c2-ed54-5de4-84eb-c837c3a53a68","fields":{"slug":"/2020-02-reactpuppeteer/"},"headings":[{"value":"Puppeteer 介紹","id":"puppeteer-介紹","depth":2},{"value":"主要功能","id":"主要功能","depth":3},{"value":"安裝環境","id":"安裝環境","depth":2},{"value":"執行頁面載入 screenShot","id":"執行頁面載入-screenshot","depth":3},{"value":"模擬網頁互動","id":"模擬網頁互動","depth":3},{"value":"測試 facebook login","id":"測試-facebook-login","depth":2},{"value":"搭配 Jest 測試","id":"搭配-jest-測試","depth":2},{"value":"建立測試檔案","id":"建立測試檔案","depth":2},{"value":"心得","id":"心得","depth":2}],"excerpt":"最近接觸某個重要專案，這專案很特別，每個狀態都會對應不同 config 有不同回應，網頁操作、業務邏輯十分之複雜，大概就像是 tree structure 一樣。我負責翻新頁面的 login flow，雖然我對改動邏輯掌握度高，但我滿擔心是否有沒看到的功能，會關聯到舊邏輯。 因為 use case…","html":"<p>最近接觸某個重要專案，這專案很特別，每個狀態都會對應不同 config 有不同回應，網頁操作、業務邏輯十分之複雜，大概就像是 tree structure 一樣。我負責翻新頁面的 login flow，雖然我對改動邏輯掌握度高，但我滿擔心是否有沒看到的功能，會關聯到舊邏輯。</p>\n<p>因為 use case 實在太繁雜了，每次都需要請 PM 或工程師手動測試，但又常常漏掉某些特殊情境，讓我有感而發，如果有跑測試就好了。有剛好有時間就來研究一下，要如何在 react 專案上跑 End to End Test。</p>\n<!--- ![react puppeteerjest](../images/puppeteerjest.png \"react puppeteerjest\") --->\n<h2 id=\"puppeteer-介紹\" style=\"position:relative;\"><a href=\"#puppeteer-%E4%BB%8B%E7%B4%B9\" aria-label=\"puppeteer 介紹 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Puppeteer 介紹</h2>\n<p>Puppeteer 是由 Chrome DevTools team 團隊開發的，它是一個 node library 工具，提供 API 讓我們控制 chrome 或 Chromium，並能以 headless chrome(chrome without chrome) 或正常模式執行。相對於 Selenium 專注在跨瀏覽器測試，Puppeteer 則是專注依賴 Chromium 並使用相關的 API 測試。</p>\n<h3 id=\"主要功能\" style=\"position:relative;\"><a href=\"#%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD\" aria-label=\"主要功能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>主要功能</h3>\n<ol>\n<li>產生 pdf 網頁快照。</li>\n<li>render 頁面是基於 single page application 架構的頁面，並產生靜態內容。</li>\n<li>自動化測試，input、鍵盤、UI 測試。</li>\n<li>能夠使用最新的 chrome 環境進行測試。</li>\n<li>產生頁面優化診斷。</li>\n<li>測試 chrome extension。</li>\n</ol>\n<p><a href=\"https://developers.google.com/web/tools/puppeteer\" title=\"Puppeteer 官方介紹\">Puppeteer 官方介紹</a></p>\n<p>這個需要測試的頁面是以 React 開發，純 client side render，E2E 測試也需要處理 render SPA，適合我們的情境。</p>\n<h2 id=\"安裝環境\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E8%A3%9D%E7%92%B0%E5%A2%83\" aria-label=\"安裝環境 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安裝環境</h2>\n<p>建立資料夾，並安裝 package.json 、 puppeteer 等相關設定，接下來建立 js 檔案來使用 node 測試 puppeteer。</p>\n<deckgo-highlight-code   >\n          <code slot=\"code\">mkdir test-puppeteer\ncd test-puppeteer\nnpm init -f\nnpm install --save-dev puppeteer dotenv\ntouch test.js</code>\n        </deckgo-highlight-code>\n<h3 id=\"執行頁面載入-screenshot\" style=\"position:relative;\"><a href=\"#%E5%9F%B7%E8%A1%8C%E9%A0%81%E9%9D%A2%E8%BC%89%E5%85%A5-screenshot\" aria-label=\"執行頁面載入 screenshot permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>執行頁面載入 screenShot</h3>\n<p>接下來嘗試載入 google 頁面，並且自動輸入值來使用 google search。首先我們需要 引入 puppeteer，並執行 puppeteer.launch 啟動 puppeteer，再利用 goto 來載入 <a href=\"https://google.com\">https://google.com</a> 頁面，接下來執行 screenshot 並命名 image 儲存位置，接下來 執行 node test，成功跑起來的話會發現新增了 screenshot_google.png ，打開來就是模擬 screenshot 的畫面。</p>\n<p><a href=\"https://pptr.dev/#?product=Puppeteer&#x26;version=v2.1.1&#x26;show=outline\" title=\"Puppeteer 文件\">Puppeteer 文件</a></p>\n<ul>\n<li>google.js</li>\n</ul>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">const puppeteer = require(&quot;puppeteer&quot;);\n\n(async () =&gt; {\n  const browser = await puppeteer.launch();\n  const page = await browser.newPage();\n  await page.goto(&quot;https://google.com&quot;);\n  await page.screenshot({ path: &quot;./screenshot_google.png&quot; });\n  await browser.close();\n})();</code>\n        </deckgo-highlight-code>\n<h3 id=\"模擬網頁互動\" style=\"position:relative;\"><a href=\"#%E6%A8%A1%E6%93%AC%E7%B6%B2%E9%A0%81%E4%BA%92%E5%8B%95\" aria-label=\"模擬網頁互動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>模擬網頁互動</h3>\n<p>使用 page.evaluate(function) 功能，可以讓我們執行 javascript，這邊我們會使用 javascript DOM selector 輸入搜尋框，並且點擊送出搜尋按鈕，再來 page.waitForNavigation() 等待頁面導覽完成，再來繼續執行 evaluate 點擊第一個搜尋結果的標題，最後執行 screenShot。</p>\n<p>簡單講就是用 JavaScript 模擬使用者互動操作，來促使畫面更新變動，再截圖存取畫面。</p>\n<p>page.evaluate 可以執行 javascript，直接以 selector 操作，這邊模擬輸入 coronavirus，並且執行 click submit，接下來 page.waitForNavigation 等待網頁導覽，接下來 page.evaluate 執行第一篇搜尋結果標題 click，最後執行 page.screenshot，截圖儲存並關閉。就完成了一個簡易的 puppeteer 測試。</p>\n<ul>\n<li>google.js</li>\n</ul>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">(async () =&gt; {\n    ...\n  await page.evaluate(() =&gt; {\n    document.querySelector(&quot;input[type=&#39;search&#39;]&quot;).value = &quot;coronavirus&quot;;\n    document.querySelector(&quot;button[jsaction=&#39;click:.CLIENT&#39;]&quot;).click();\n  });\n  await page.waitForNavigation();\n  await page.evaluate(() =&gt; {\n    document.querySelector(&#39;#rso div[role=&quot;heading&quot;]&#39;).click();\n  });\n  await page.waitForNavigation();\n  await page.screenshot({ path: &quot;./screenshot_google_search.png&quot; });\n  await browser.close();\n})();</code>\n        </deckgo-highlight-code>\n<p><img src=\"/d9d735bc2d49bf6ef1ed398eb719d467/googlecorona.gif\" alt=\"googlecorona\" title=\"googlecorona\"></p>\n<p><a href=\"https://puppeteersandbox.com/P0aWYvFO\" title=\"puppeteersandbox google Demo\">puppeteersandbox google Demo</a></p>\n<h2 id=\"測試-facebook-login\" style=\"position:relative;\"><a href=\"#%E6%B8%AC%E8%A9%A6-facebook-login\" aria-label=\"測試 facebook login permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>測試 facebook login</h2>\n<p>接下來測試一直想跑的 facebook login，曾經某天 facebook 偷偷改版 api，造成整個產品的 login 服務掛掉，或是前幾個月 facebook 連線就出問題了，但這都是在客戶端回報才發現到問題，所以期待這段以 cronjob 定時 run，來確保登入功能是正常的。</p>\n<p>首先載入頁面，假設是手機版，頁面會自動跳出登入按鈕，按鈕上有寫上特殊的 attribute id=“e2e-login-button”，接下來等待這個按鈕顯示，可以使用 page.waitForSelector 等待這個 element visible，執行 button click。</p>\n<p>倒轉到 facebook 網頁後，用 page.evaluate 執行 javascript，填入 facebook 帳號、密碼，再來點擊 facebook 登入按鈕，登入完成後會出現授權頁面，同樣點擊確認授權按鈕。</p>\n<p>倒轉回到原本網站，接下來就判斷是否顯示 登出按鈕，確保使用者有完成登入流程。</p>\n<p>核心邏輯大概就是 waitForSelector 等待 DOM render，並且 page.evaluate 執行互動，在等待 DOM render，執行互動 loop，達成我們所期待的畫面滾動。</p>\n<ul>\n<li>fbLogin.js</li>\n</ul>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">require(&quot;dotenv&quot;).config();\nconst puppeteer = require(&quot;puppeteer&quot;);\nconst devices = require(&quot;puppeteer/DeviceDescriptors&quot;);\n\n(async () =&gt; {\n  const browser = await puppeteer.launch();\n  const page = await browser.newPage();\n  await page.emulate(devices[&quot;iPhone 7&quot;]);\n  await page.goto(&quot;https://www.feversocial.com/promo/join?promoid=134364&quot;);\n\n  await page.waitForSelector(&quot;#e2e-login-button&quot;, {\n    visible: true\n  });\n\n  await page.click(&quot;#e2e-login-button&quot;);\n  await page.waitForSelector(&quot;#email_input_container&quot;, {\n    visible: true\n  });\n\n  await page.evaluate(\n    (account, password) =&gt; {\n      document.querySelector(&quot;#email_input_container input&quot;).value =\n        process.env.FBACCOUNT;\n      document.querySelector(&quot;input[type=&#39;password&#39;]&quot;).value =\n        process.env.FBPASSWORD;\n      document.querySelector(&quot;button[name=&#39;login&#39;]&quot;).click();\n    },\n    process.env.FBACCOUNT,\n    process.env.FBPASSWORD\n  );\n\n  await page.waitForSelector(&quot;button[name=&#39;__CONFIRM__&#39;]&quot;, {\n    visible: true\n  });\n\n  await page.evaluate(() =&gt; {\n    document.querySelector(&quot;button[name=&#39;__CONFIRM__&#39;]&quot;).click();\n  });\n\n  await page.waitForSelector(&quot;div[type=&#39;0&#39;]&quot;, {\n    visible: true\n  });\n\n  await page.waitForFunction(\n    `document.querySelectorAll(&#39;div[type=&quot;0&quot;]&#39;)[1].textContent === &#39;登出&#39;`\n  );\n  await page.screenshot({ path: &quot;example.png&quot;, fullPage: true });\n\n  await browser.close();\n})();</code>\n        </deckgo-highlight-code>\n<p><img src=\"/37e38b7ff813e263d52a6bf2cae84408/fever_fblogin.gif\" alt=\"fever fblogin\" title=\"fever fblogin\"></p>\n<p>提醒一下，這個測試情境只針對曾經給予過 facebook auth 權限，因為跑完每次還要 reset auth 非常不方便。</p>\n<ul>\n<li>記得修改 facebook 帳號密碼 ( 如果擔心線上測試有資安疑慮，就避免使用，我是都用專門測試的帳號 )</li>\n</ul>\n<p><a href=\"https://puppeteersandbox.com/gThYhDA2\" title=\"puppeteersandbox facebook login Demo\">puppeteersandbox facebook login Demo</a></p>\n<h2 id=\"搭配-jest-測試\" style=\"position:relative;\"><a href=\"#%E6%90%AD%E9%85%8D-jest-%E6%B8%AC%E8%A9%A6\" aria-label=\"搭配 jest 測試 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搭配 Jest 測試</h2>\n<p>上述都是使用 puppeteer 建出流程，但實際上還需要搭配測試斷言工具，這樣才能讓判斷出測試 case 是不是正常，如果不正常的話是哪個流程有問題等等。</p>\n<p>這邊使用到 Jest，環境設定與之前 Jest 大同小異，主要是需要安裝支援 puppeteer 的工具，讓 Jest 能夠執行 puppeteer 環境，基本上沒有太大的難度。如果遇到問題的話 Jest 官網也有 source code 可以提供下載。</p>\n<ul>\n<li>安裝 Jest</li>\n</ul>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">npm install --save-dev jest-puppeteer jest</code>\n        </deckgo-highlight-code>\n<p>建立 jest.config.js, jest.setup.js</p>\n<ul>\n<li>jest.config.js</li>\n</ul>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">module.exports = {\n  preset: &quot;jest-puppeteer&quot;,\n  setupFilesAfterEnv: [&quot;./jest.setup.js&quot;]\n};</code>\n        </deckgo-highlight-code>\n<p>設定環境以及應用 setup 設定</p>\n<ul>\n<li>jest.setup.js</li>\n</ul>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">jest.setTimeout(10000);</code>\n        </deckgo-highlight-code>\n<p>延長 jest default 8000 msec 時間限制</p>\n<p><a href=\"https://jestjs.io/docs/en/puppeteer\" title=\"Jest with Puppeteer\">Jest with Puppeteer</a></p>\n<p><a href=\"https://github.com/checkly/puppeteer-examples\" title=\"Puppeteersandbox github sample code\">Puppeteersandbox github sample code</a></p>\n<h2 id=\"建立測試檔案\" style=\"position:relative;\"><a href=\"#%E5%BB%BA%E7%AB%8B%E6%B8%AC%E8%A9%A6%E6%AA%94%E6%A1%88\" aria-label=\"建立測試檔案 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>建立測試檔案</h2>\n<p>首先建立 <code class=\"language-text\">_test_</code> folder，接下來建立 login.spec.js，針對整個登入流程做判斷，預期之外的狀況就截圖，並且拋出相對錯誤訊息。Jest 無法跳出瀏覽器模擬，所以直接設定 headless 即可。</p>\n<p>將上面的 fbLogin.js script 貼上來作為修改，waitForSelector 增加 timeout，避免卡在一個狀態過久浪費時間，增加 try catch，針對錯誤進行截圖，方便出問題時 debug。</p>\n<p>其餘與一般的 jest 差別不大，就是在預期發生錯誤增加斷言判斷等，這邊就不特別介紹了。實際內容再請觀看 github 上檔案。</p>\n<p>小雷，process 我卡了大概 30 分鐘，process.env.FBPASSWORD 要用 function 作為參數帶入，直接在 evaluate callback function 內，因為環境緣故，是無法取得 process.env 的值。還有其他 dom selector 怎樣寫比較不會出錯等等，這是最耗時的部分，因為是 side project，沒有直接去改 dom 的 tag attribute，因為滿多強硬的 selector 寫法，建議大家還是好好 naming 狀態。</p>\n<ul>\n<li>login.spec.js</li>\n</ul>\n<deckgo-highlight-code language=\"javascript\"  >\n          <code slot=\"code\">...\nbeforeEach(async () =&gt; {\n  await page.goto(\n    &quot;https://www.feversocial.com/promo/join?promoid=134230&quot;\n  );\n});\n\ndescribe(&quot;Login&quot;, () =&gt; {\n  it(&quot;Fever Login Flow&quot;, async done =&gt; {\n    await page.emulate(devices[&quot;iPhone 7&quot;]);\n    await page.waitForSelector(&quot;#e2e-login-button&quot;, {\n      visible: true,\n      timeout: 1500\n    });\n\n    try {\n      const buttonHref = await page.$eval(&#39;#e2e-login-button&#39;, el =&gt; el.href);\n      await expect(buttonHref).not.toBe(&#39;&#39;);\n    } catch (error) {\n      await page.screenshot({ path: &quot;./promo_button_href_error.png&quot; });\n    }\n\n    await page.click(&quot;#e2e-login-button&quot;);\n...\n    await page.evaluate((account, password) =&gt; {\n      document.querySelector(&quot;#email_input_container input&quot;).value = account;\n      document.querySelector(&quot;input[type=&#39;password&#39;]&quot;).value = password;\n      document.querySelector(&quot;button[name=&#39;login&#39;]&quot;).click();\n    }, process.env.FBACCOUNT, process.env.FBPASSWORD);\n...</code>\n        </deckgo-highlight-code>\n<p>Source Code : <a href=\"https://github.com/Ianpig/puppeteer-jest-example\" title=\"puppeteer-jest-example\">puppeteer-jest-example</a></p>\n<h2 id=\"心得\" style=\"position:relative;\"><a href=\"#%E5%BF%83%E5%BE%97\" aria-label=\"心得 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>心得</h2>\n<p>這些看起來很簡單，但這些我大概花了 3 天時間，雖然撥出來的時間零零碎碎，剛好某天開發時間有多出時間，就來嘗試用 puppeteer 寫一個測試登入，實際上未來要在搭配 docker 部署上去並以專案 release 時自動觸發，然後出現錯誤要 alarm，這有空再嘗試研究…。</p>\n<p>以上如果有問題歡迎留言，感謝。</p>","frontmatter":{"title":"Puppeteer End-to-End Test React","date":"February 28, 2020","description":"會以 Puppeteer 在 react 專案上跑 End to End Test。puppeteer 是由 Chrome DevTools team 團隊開發的，它是一個 node library 工具，提供 API 讓我們控制 chrome 或 Chromium，模擬執行各種功能。","categories":"javascript","tags":["react.js"],"thumbnail":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAACJ0lEQVQozxWPiW6iABRF+ZmZVKsoinWDQkVckbrUBVSWIKK4IEJBAdGqnWkzTZNO5oOHJjcnucnNy3lAKNIMg53bePcW6oehXjQ5jMEjEB7HYC6WEoLEU2LAKMSEY90Q2LuJtG8izZ+hxo8wDUQTAzDJgPAwkR5mkXEOEfL3Yv5eQrAJgkkoLqGYnEOFPMpn81w6O0xnmHiyF4q2wfgYgO5G8bsRmOKIosQPZkxnOmhO2LY87Cijp9nwSWE7CtuSmZbcb0q9R3H8JGP34xDYBRMjIJERklkhnhHLFYXrznTVs7RTwO3isFYcY3WytLOxPATVXPn60uP7UxznI9C3LJBCJmlUhvPTak3le3N7c35xP3bbq7W52PqrpV+D6ttva2V/cv445pXrKQVCBOHAdwzkcDX3oKaxBdVYCX3VNX+dvY+D/X7cf1z8r+vx63lz8Xfvi8nucvh0zFeRUYslGcqIUJoDUEJDi1q+sKFpXR5pq6kTTN8u/17cz5P7+Xr6a67PjvnbWPjB0cBIYpdkWUnkJDgnAVhpi5dNlDQem9spbwiszvU1brDhBzrPbMd9Xfjmmh+s2faM7cxFdlWqqDCi3KFT4KFmEXW7ULPJ+q5C2xV6V33c11oe1fap9rHe8iu0U6asUpD6M1E1CmUNKSxzD8ssPgfIhleiXZL2ig2PoByCcgnKI2m/1DyR9LHYOBINv1B38doeq+6wsoWQBlLc5Ing09V/p73QeI6MmIwAAAAASUVORK5CYII=","aspectRatio":2,"src":"/static/b6532504d32a73de3210b9baf63cf00f/44ef2/puppeteerjest.png","srcSet":"/static/b6532504d32a73de3210b9baf63cf00f/c972b/puppeteerjest.png 340w,\n/static/b6532504d32a73de3210b9baf63cf00f/27625/puppeteerjest.png 680w,\n/static/b6532504d32a73de3210b9baf63cf00f/44ef2/puppeteerjest.png 890w","sizes":"(max-width: 890px) 100vw, 890px"}}}},"timeToRead":7,"parent":{"__typename":"File","modifiedTime":"2021-04-03T11:16:59.788Z"}}},"pageContext":{"slug":"/2020-02-reactpuppeteer/","previous":{"fields":{"slug":"/2019-12-iframeblockcookie/"},"frontmatter":{"title":"阻擋第三方(Block third-party) Cookie，各瀏覽器狀態","tags":["javascript"]}},"next":{"fields":{"slug":"/2020-04-immutable/"},"frontmatter":{"title":"Immutable 對於 React 重要性","tags":["javascript","react.js"]}}}},"staticQueryHashes":["1481458783","63159454"]}